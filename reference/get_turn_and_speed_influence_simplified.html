<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Get simplified turn and speed influence — get_turn_and_speed_influence_simplified • cocomo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Get simplified turn and speed influence — get_turn_and_speed_influence_simplified"><meta name="description" content="Get the simplified turn and speed influence (movement and positional) between all pairs of individuals
i and j, or, if centroid = T for all individuals i on the group centroid excluding i."><meta property="og:description" content="Get the simplified turn and speed influence (movement and positional) between all pairs of individuals
i and j, or, if centroid = T for all individuals i on the group centroid excluding i."></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cocomo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Get simplified turn and speed influence</h1>

      <div class="d-none name"><code>get_turn_and_speed_influence_simplified.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Get the simplified turn and speed influence (movement and positional) between all pairs of individuals
<code>i</code> and <code>j</code>, or, if <code>centroid = T</code> for all individuals <code>i</code> on the group centroid excluding <code>i</code>.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get_turn_and_speed_influence_simplified</span><span class="op">(</span></span>
<span>  <span class="va">xs</span>,</span>
<span>  <span class="va">ys</span>,</span>
<span>  <span class="va">heading_type</span>,</span>
<span>  centroid <span class="op">=</span> <span class="cn">F</span>,</span>
<span>  breaks <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  spatial_R <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  t_window <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_percentile <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  seconds_per_time_step <span class="op">=</span> <span class="fl">1</span>,</span>
<span>  symmetrize_lr <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  max_distance <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_past_speed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_left_speed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_right_speed <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_left_pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_right_pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_faster_speed_diff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_slower_speed_diff <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_front_pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  min_back_pos <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  verbose <span class="op">=</span> <span class="cn">T</span>,</span>
<span>  output_details <span class="op">=</span> <span class="cn">T</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xs">xs<a class="anchor" aria-label="anchor" href="#arg-xs"></a></dt>
<dd><p><code>N x n_times</code> matrix giving x coordinates of each individual over time</p></dd>


<dt id="arg-ys">ys<a class="anchor" aria-label="anchor" href="#arg-ys"></a></dt>
<dd><p><code>N x n_times</code> matrix giving y coordinates of each individual over time</p></dd>


<dt id="arg-heading-type">heading_type<a class="anchor" aria-label="anchor" href="#arg-heading-type"></a></dt>
<dd><p>character string specifying heading type - <code>'spatial'</code> or <code>'temporal'</code></p></dd>


<dt id="arg-centroid">centroid<a class="anchor" aria-label="anchor" href="#arg-centroid"></a></dt>
<dd><p>whether to use the group centroid (if <code>centroid = T</code>) instead of computing influence for each dyad (if <code>centroid = F</code>)</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>vector of indexes to breaks in the data (e.g. breaks between days)</p></dd>


<dt id="arg-spatial-r">spatial_R<a class="anchor" aria-label="anchor" href="#arg-spatial-r"></a></dt>
<dd><p>radius to use for spatial headings (if <code>heading_type = 'spatial'</code>)</p></dd>


<dt id="arg-t-window">t_window<a class="anchor" aria-label="anchor" href="#arg-t-window"></a></dt>
<dd><p>temporal window to use for temporal headings (if <code>heading_type = 'temporal'</code>)</p></dd>


<dt id="arg-min-percentile">min_percentile<a class="anchor" aria-label="anchor" href="#arg-min-percentile"></a></dt>
<dd><p>minimum percentile to use for left / right relative speed or distance</p></dd>


<dt id="arg-seconds-per-time-step">seconds_per_time_step<a class="anchor" aria-label="anchor" href="#arg-seconds-per-time-step"></a></dt>
<dd><p>number of seconds corresponding to each time step</p></dd>


<dt id="arg-symmetrize-lr">symmetrize_lr<a class="anchor" aria-label="anchor" href="#arg-symmetrize-lr"></a></dt>
<dd><p>whether to symmetrize the thresholds for right and left movement + position (default <code>T</code>)</p></dd>


<dt id="arg-max-distance">max_distance<a class="anchor" aria-label="anchor" href="#arg-max-distance"></a></dt>
<dd><p>optional maximum distance between a pair of individuals, or between an individual and the centroid, to include a given time point in the influence calculations</p></dd>


<dt id="arg-min-past-speed">min_past_speed<a class="anchor" aria-label="anchor" href="#arg-min-past-speed"></a></dt>
<dd><p>optional minimum previous speed of either the group centroid (if <code>centroid = T</code>) or the 'follower' (if <code>centroid = F</code>) to include data in the computation - can be used to subset to only times when the individual or group are already moving</p></dd>


<dt id="arg-min-left-speed">min_left_speed<a class="anchor" aria-label="anchor" href="#arg-min-left-speed"></a></dt>
<dd><p>minimum speed when i moving to the left to include data (positive value)</p></dd>


<dt id="arg-min-right-speed">min_right_speed<a class="anchor" aria-label="anchor" href="#arg-min-right-speed"></a></dt>
<dd><p>minimum speed when i moving to the right to include data (positive value)</p></dd>


<dt id="arg-min-left-pos">min_left_pos<a class="anchor" aria-label="anchor" href="#arg-min-left-pos"></a></dt>
<dd><p>minimum distance of i to the left of j to include data (positive value)</p></dd>


<dt id="arg-min-right-pos">min_right_pos<a class="anchor" aria-label="anchor" href="#arg-min-right-pos"></a></dt>
<dd><p>minimum distance of i to the right to j include data (positive value)</p></dd>


<dt id="arg-min-faster-speed-diff">min_faster_speed_diff<a class="anchor" aria-label="anchor" href="#arg-min-faster-speed-diff"></a></dt>
<dd><p>minimum speed difference between i and j when i is going faster to include data (positive value)</p></dd>


<dt id="arg-min-slower-speed-diff">min_slower_speed_diff<a class="anchor" aria-label="anchor" href="#arg-min-slower-speed-diff"></a></dt>
<dd><p>minimum speed difference between i and j when i is going slower to include data (positive value)</p></dd>


<dt id="arg-min-front-pos">min_front_pos<a class="anchor" aria-label="anchor" href="#arg-min-front-pos"></a></dt>
<dd><p>minimum position toward the front when i is in front of j to include data (positive value)</p></dd>


<dt id="arg-min-back-pos">min_back_pos<a class="anchor" aria-label="anchor" href="#arg-min-back-pos"></a></dt>
<dd><p>minimum position toward the back when i is in back of j to include data (positive value)</p></dd>


<dt id="arg-verbose">verbose<a class="anchor" aria-label="anchor" href="#arg-verbose"></a></dt>
<dd><p>whether the print progress (if <code>T</code>)</p></dd>


<dt id="arg-output-details">output_details<a class="anchor" aria-label="anchor" href="#arg-output-details"></a></dt>
<dd><p>whether to output computed matrices and arrays used in influence computations (if <code>T</code>)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>Returns a list containing matrices for the 4 different types of influence, as well as other computed metrics (if <code>output_details = T</code>).
See "Additional information about returned objects" section below for a list of outputs.</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>The simplified movement turn influence of individual <code>i</code> on individual <code>j</code> (<code>turn_influence_movement[i,j]</code>)
is defined as the probability that <code>j</code> turns right in the future given that <code>i</code> moved
right relative to <code>j</code>'s past heading at a speed above a threshold value <code>min_right_speed</code>,
that <code>j</code> turns left in the future given that <code>i</code> moved left relative to <code>j</code>'s past heading at a speed above a threshold
value <code>min_left_speed</code>.</p>
<p>The simplified positional turn influence of individual <code>i</code> on individual <code>j</code> (<code>turn_influence_position[i,j]</code>)
is defined as the probability that <code>j</code> turns right in the future given that <code>i</code> was located
at least <code>min_right_dist</code> meters right of individual <code>j</code> relative to <code>j</code>'s current position
and heading, or that <code>j</code> turns left in the future given that <code>i</code> was located
at least <code>min_left_dist</code> meters left of individual <code>j</code> relative to <code>j</code>'s current position
and heading.</p>
<p>The simplified movement speed influence of individual <code>i</code> on individual <code>j</code> (<code>speed_influence_movement[i,j]</code>)
is defined as the probability that <code>j</code> speeds up in the future along the vector defined by <code>j</code>'s heading in the past,
given that <code>i</code> was moving at least a speed <code>min_faster_speed_diff</code> faster than <code>j</code> along <code>j</code>'s past heading direction, or
slows down along the vector defined by <code>j</code>'s heading in the past given that <code>j</code> was moving at least a speed <code>min_slower_speed_diff</code>
slower than <code>i</code> along the same vector in the past.</p>
<p>The simplified positional speed influence of individual <code>i</code> on individual <code>j</code> (<code>speed_influence_position[i,j]</code>)
is defined as the probability that <code>j</code> speeds up in the future along the vector defined by <code>j</code>'s heading in the past
given that <code>i</code> was in front of <code>j</code> by at least <code>min_front_pos</code> meters relative to <code>j</code>'s current position and past heading,
or that <code>j</code> slows down in the future along the vector defined by <code>j</code>'s heading in the past given that <code>i</code> was
behind <code>j</code> by at least <code>min_back_pos</code> relative to <code>j</code>'s current position and past heading.</p>
<p>Future headings and speeds are computed either using a fixed temporal window <code>t_window</code> forward in time (if <code>heading_type = 'temporal'</code>)
or based on spatial discretization with a radius <code>spatial_R</code> (if <code>heading_type = 'spatial'</code>), i.e. defining the heading based on the
when the focal individual has moved a distance <code>spatial_R</code> from its current location. Similarly, past headings and speeds
are computed by looking backward in time either at a fixed temporal window (<code>t_window</code>) or based on a fixed displacement distance (<code>spatial_R</code>).</p>
<p>The parameters specifying minimum speeds and distances left-right and front-back are either set manually (not recommended) or,
if <code>min_percentile</code> is specified, based on percentiles of the relevant distributions of these variables across all dyads
(or across all individuals relative to the group centroid, if <code>centroid = T</code>). The variable
<code>min_percentile</code> overrides the manually set minimum speeds / distances.
The minimum speeds (or distances) are computed as follows. First, split the distribution of relative left-right
speeds (for example) across all dyads into those greater than and those less than 0. Take the absolute value of all speeds to
define a positive speed for both directions. Next, compute the quantile <code>min_percentile</code> for each distribution (left and right) separately.
Finally, set <code>min_left_speed</code> and <code>min_right_speed</code> at the computed
values. If <code>symmetrize_lr = T</code> (recommended), take instead the mean value of the quantiles for both distributions and use it
for both thresholds (this will result in using the same relative speed when going right or left as a threshold - otherwise these could be different if <code>symmetrize_lr = F</code>)
The same procedure is done for left-right positions, front-back relative speeds, and front-back positions, using the same value of <code>min_percentile</code>. In the case of
speeds, no symmetrization is done because speed differences and front-back distances are not expected to be symmetrical.</p>
<p>If <code>breaks</code> is set, headings that go across breaks in the data as specified by this vector are not included in the computations.</p>
<p>If <code>max_distance</code> is set, only compute the scores based on times when the distance between a given pair of individuals (or between)
an individual and the group centroid) is less than <code>max_distance</code>. By default <code>max_distance = NULL</code> and this filtering will not be done.</p>
<p>If <code>min_past_speed</code> is set, only compute the scores based on times when the follower individual (or the centroid, if <code>centroid = T</code>)
was initially moving at a minimum past speed. By default, <code>min_past_speed = NULL</code> and this filtering will not be done.</p>
    </div>
    <div class="section level2">
    <h2 id="additional-information-about-returned-objects">Additional information about returned objects<a class="anchor" aria-label="anchor" href="#additional-information-about-returned-objects"></a></h2>



<p>The output list conatins the following objects:</p>
<p><code>params</code> list of parameters used in the calculation (see input variables for descriptions)</p>
<p><code>turn_influence_movement</code>: <code>i x j</code> matrix representing movement turn influence of individual <code>i</code> on individual <code>j</code></p>
<p><code>turn_influence_position</code>: <code>i x j</code> matrix representing positional turn influence of individual <code>i</code> on individual <code>j</code></p>
<p><code>speed_influence_movement</code>: <code>i x j</code> matrix representing movement speed influence of individual <code>i</code> on individual <code>j</code></p>
<p><code>speed_influence_position</code>: <code>i x j</code> matrix representing positions speed influence of individual <code>i</code> on individual <code>j</code></p>
<p>If <code>centroid = T</code>, everything is instead computed at the centroid level (with the centroid as follower, replacing individual <code>j</code>).
In this case, the output matrices will still be the same shape as those for the dyadic case, but they will have <code>NA</code>s for all columns
except <code>j=1</code> (representing the influence of each individual <code>i</code> on the centroid excluding that individual).
This parallel structure is for compatibility between dyadic and centroid-based analyses.</p>
<p>If <code>output_details = T</code>, some additional parameters and the following computed matrices / arrays will also be outputted:</p>
<p><code>lr_speed</code>: <code>i x j x t</code> array of the past left-right speed of individual <code>i</code> relative to the past heading of individual <code>j</code> at time <code>t</code></p>
<p><code>lr_pos</code>: <code>i x j x t</code> array of the past left-right position of individual <code>i</code> relative to the current position and past heading of individual <code>j</code> at time <code>t</code></p>
<p><code>fb_speed</code>: <code>i x j x t</code> array of the past front-back speed difference between individual <code>i</code> and individual <code>j</code> along the vector of the past heading of individual <code>j</code> at time <code>t</code></p>
<p><code>fb_pos</code>: <code>i x j x t</code> array of the past front-back position of individual <code>i</code> relative to the current position and past heading of individual <code>j</code> at time <code>t</code></p>
<p><code>turn_angle</code>: <code>j x t</code> matrix of the turning angle of individual <code>j</code> between the past and future at time <code>t</code></p>
<p><code>speed_up</code>: <code>j x t</code> matrix of the difference in speed of individual <code>j</code> between future and past at time <code>t</code>, project along <code>j</code>'s own past heading</p>
<p>The output matrices <code>turn_angle[j,t]</code> and <code>speed_up[j,t]</code> then represent the centroid excluding individual <code>j</code>, rather than
the data for individual <code>j</code> as in the dyadic case.
Similarly, the output arrays with dimensions <code>i x j x t</code> will have <code>NA</code>s for all values of <code>j &gt; 1</code>, and the <code>j = 1</code>
values represent the speeds / positions of individuals relative to the centroid (excluding <code>i</code>)</p>
    </div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ariana Strandburg-Peshkin (primary author)</p>
<p>Jack Winans (code reviewer, 15 August 2024)</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ariana Strandburg-Peshkin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

