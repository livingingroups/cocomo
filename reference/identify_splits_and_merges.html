<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Identify group splits and merges from multi-individual trajectory data — identify_splits_and_merges • cocomo</title><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Identify group splits and merges from multi-individual trajectory data — identify_splits_and_merges"><meta name="description" content='Detects splits and merges (a.k.a. fissions and fusions) using "sticky-DBSCAN"
method from Libera et al. 2023.'><meta property="og:description" content='Detects splits and merges (a.k.a. fissions and fusions) using "sticky-DBSCAN"
method from Libera et al. 2023.'></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">cocomo</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="active nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json"></form></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Identify group splits and merges from multi-individual trajectory data</h1>

      <div class="d-none name"><code>identify_splits_and_merges.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Detects splits and merges (a.k.a. fissions and fusions) using "sticky-DBSCAN"
method from Libera et al. 2023.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">identify_splits_and_merges</span><span class="op">(</span></span>
<span>  <span class="va">xs</span>,</span>
<span>  <span class="va">ys</span>,</span>
<span>  <span class="va">timestamps</span>,</span>
<span>  <span class="va">R_inner</span>,</span>
<span>  <span class="va">R_outer</span>,</span>
<span>  breaks <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">timestamps</span><span class="op">)</span> <span class="op">+</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>  names <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  break_by_day <span class="op">=</span> <span class="cn">F</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-xs">xs<a class="anchor" aria-label="anchor" href="#arg-xs"></a></dt>
<dd><p>UTM eastings matrix (<code>n_inds</code> x <code>n_times</code> matrix where xs[i,t] gives the easting of individual i at time step t)</p></dd>


<dt id="arg-ys">ys<a class="anchor" aria-label="anchor" href="#arg-ys"></a></dt>
<dd><p>UTM northings matrix (<code>n_inds</code> x <code>n_times</code> matrix where ys[i,t] gives the northing of individual i at time step t)</p></dd>


<dt id="arg-timestamps">timestamps<a class="anchor" aria-label="anchor" href="#arg-timestamps"></a></dt>
<dd><p>vector of timestamps (POSIXct), must have same dimensions as columns of <code>xs</code> and <code>ys</code> matrices</p></dd>


<dt id="arg-r-inner">R_inner<a class="anchor" aria-label="anchor" href="#arg-r-inner"></a></dt>
<dd><p>inner distance threshold to identify periods of connectedness (numeric)</p></dd>


<dt id="arg-r-outer">R_outer<a class="anchor" aria-label="anchor" href="#arg-r-outer"></a></dt>
<dd><p>outer distance threshold to identify periods of connectedness (numeric)</p></dd>


<dt id="arg-breaks">breaks<a class="anchor" aria-label="anchor" href="#arg-breaks"></a></dt>
<dd><p>indexes to breaks in the data (default NULL treats data as a contiguous sequence). If specified, overrides <code>break_by_day</code></p></dd>


<dt id="arg-names">names<a class="anchor" aria-label="anchor" href="#arg-names"></a></dt>
<dd><p>optional vector of names (if NULL, will be defined as <code>as.character(1:n_inds)</code>)</p></dd>


<dt id="arg-break-by-day">break_by_day<a class="anchor" aria-label="anchor" href="#arg-break-by-day"></a></dt>
<dd><p>whether to break up data by date (T or F)</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>a list containing:</p>
<p><code>events_detected</code>: data frame with info on detected fissions and fusions, and limited info for shuffles</p>
<p><code>all_events_info</code>: list of information about all fission-fusion (or shuffle)
events.</p>
<p><code>groups_list</code>: list of subgroups in each timestep</p>
<p><code>together</code>: n_inds x n_inds x n_times array of whether dyads are
connected (1) or not (0) or unknown (NA)</p>
<p><code>R_inner</code>: inner radius used in the computations (same as <code>R_inner</code> above)</p>
<p><code>R_outer</code>: outer radius used in the computations (same as <code>R_outer</code> above)</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>Start by defining an adjacency matrix (<code>together</code> in the code) of which dyads
are "connected" at any moment in time. Dyads are considered to be connected if
they go within a distance <code>R_inner</code> of one another, and they continue to be
connected until they leave a distance <code>R_outer</code> of one another on both ends
(before and after) of the period where their distance dropped below <code>R_inner</code>.
This double threshold makes periods of connectedness more stable by removing
the "flicker" that would result from having a single threshold.</p>
<p>NA handling:
Individuals are considered not together if either of their positions is not known. If a period of connectedness runs into an NA,
individuals will be considered as connected up until that NA.
Once connectedness of dyads is determined, merge dyads together into groups by
using DBSCAN on 1 - <code>together</code> as the distance matrix, with <code>eps</code> equal to
something small (.01 in the code).
Store these groups in <code>groups_list</code>, a list of lists whose length is equal to
<code>n_times</code>.
Stepping through the <code>groups_list</code>, identify all changes in group membership,
i.e. consecutive time points when the groups do not match. The algorithm flags
any change, including instances where individuals disappear or reappear in
groups due to missing data (but these are later ignored). Store in <code>changes</code>
data frame.</p>
<p>In a last step, identify all splits ('fission'), merges ('fusion'), and things that
cannot be classified as either fissions or fusions because they contain elements
of both ('shuffle'). This is done by constructing a bipartite network at each time
step t, where groups at time t are connected to groups at time t + 1 if they share
at least 1 member. Then, we identify the connected components of this bipartite
network. Components where a single group (node) at time t is connected to multiple
groups (nodes) at time t + 1 get identified and classified as <code>event_type = 'fission'</code>.
Components where multiple nodes at time t are connected to a single node at time t + 1
are classified as <code>event_type = 'fusion'</code>. Components where a single node at time t
is connected to a single node at time t + 1 are skipped (they are not fissions, fusions,
or shuffles). All other events where more complex things happen are classified as
<code>event_type = 'shuffle'</code>.</p>
<p>After events are identified, various event features are computed and saved in a data frame.
See list of outputs for more details.</p>
    </div>
    <div class="section level2">
    <h2 id="additional-information-about-returned-objects">Additional information about returned objects<a class="anchor" aria-label="anchor" href="#additional-information-about-returned-objects"></a></h2>



<p><code>events_detected</code> data frame:</p><ul><li><p><code>events_detected$event_idx</code>: unique id number of the event</p></li>
<li><p><code>events_detected$tidx</code>: (initial) time index of the event</p></li>
<li><p><code>events_detected$event_type</code>: "fission" or "fusion" or "shuffle"</p></li>
<li><p><code>events_detected$n_groups_before</code>: number of groups prior to the event</p></li>
<li><p><code>events_detected$n_groups_after</code>: number of groups after the event</p></li>
<li><p><code>events_detected$big_group_idxs</code>: indexes of all the individuals involved in the event</p></li>
<li><p><code>events_detected$big_group</code>: names of all the individuals involved in the event</p></li>
<li><p><code>events_detected$group_A_idxs</code>, <code>$group_B_idxs</code>, <code>$group_C_idxs</code>, etc.: individual idxs of subgroup members</p></li>
<li><p><code>events_detected$group_A</code>, <code>$group_B</code>, <code>$group_C</code>, etc.: names of subgroup members</p></li>
<li><p><code>events_detected$n_A</code>, <code>$n_B</code>, <code>$n_C</code> etc.: number of individuals in each subgroup</p></li>
<li><p><code>events_detected$n_big_group</code>: number of individuals in the big group (original group for fissions, subseq group for fusions)</p></li>
</ul><p>(NOTE: <code>big_group_idxs</code>, <code>big_group</code>, <code>group_A_idxs</code> etc.,
<code>group_A</code> etc. <code>n_A</code> etc. and <code>n_big_group</code> are set to NA for shuffles...
you can get more detailed info for shuffles from <code>all_events_info</code> object))</p>
<p><code>all_events_info</code> list:</p><ul><li><p><code>all_events_info[[i]]</code> contains the following info for event i:</p></li>
<li><p><code>all_events_info[[i]]$t</code>: time index of the event</p></li>
<li><p><code>all_events_info[[i]]$groups_before</code>: (list of lists) list of groups before the event (at time t)</p></li>
<li><p><code>all_events_info[[i]]$groups_after</code>: (list of lists) list of groups after the event (at time t + 1)</p></li>
<li><p><code>all_events_info[[i]]event_type</code>: 'fission', 'fusion', or 'shuffle' (character string)</p></li>
<li><p><code>all_events_info[[i]]$n_groups_before</code>: number of groups before the event</p></li>
<li><p><code>all_events_info[[i]]$n_groups_after</code>: number of groups after the event</p></li>
</ul><p><code>groups_list</code> list:</p><ul><li><p><code>groups_list[[t]]</code> gives a list of the subgroups at time t</p></li>
<li><p><code>groups_list[[t]][[1]]</code> gives the vector of the first subgroup, etc.</p></li>
</ul></div>
    <div class="section level2">
    <h2 id="author">Author<a class="anchor" aria-label="anchor" href="#author"></a></h2>
    <p>Ariana Strandburg-Peshkin (primary author)</p>
<p>Eli Strauss (code reviewer, May 2024)</p>
<p>Reviewed by Brock (Jan 2025)</p>
    </div>

  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Ariana Strandburg-Peshkin.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.2.</p>
</div>

    </footer></div>





  </body></html>

